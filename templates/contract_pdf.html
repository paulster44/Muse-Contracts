<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Contract {{ contract.id }}</title>
    <style>
        /* Basic Styling for PDF - Adjust as needed for layout */
        @page {
            size: letter; /* Standard paper size */
            margin: 0.75in;
        }
        body {
            font-family: sans-serif;
            font-size: 10pt;
            line-height: 1.4;
        }
        h2, h3 {
            text-align: center;
            margin-bottom: 5px;
            margin-top: 0;
            font-weight: bold;
        }
        h3 { font-size: 11pt; }
        .header-info {
             border: 1px solid #ccc;
             padding: 5px;
             margin-bottom: 15px;
             font-size: 9pt;
        }
        .header-info table {
            width: 100%;
            border-collapse: collapse;
        }
        .header-info td {
            padding: 2px 5px;
            vertical-align: top;
        }
        .label { font-weight: bold; padding-right: 5px; }
        .content-block { margin-bottom: 10px; }
        .musician-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8pt;
            margin-top: 15px;
            margin-bottom: 15px;
            border: 1px solid #555;
        }
        .musician-table th, .musician-table td {
            border: 1px solid #ccc;
            padding: 3px 5px;
            text-align: left;
            vertical-align: top;
        }
        .musician-table th { background-color: #eee; font-weight: bold; }
        .totals-table {
             width: 60%;
             margin-left: 40%; /* Push totals right */
             border-collapse: collapse;
             font-size: 9pt;
             margin-top: 10px;
             border: 1px solid #555;
        }
        .totals-table td {
             border: 1px solid #ccc;
             padding: 3px 5px;
        }
        .signature-section { margin-top: 30px; }
        .signature-box {
             display: inline-block; /* Basic side-by-side attempt */
             width: 45%;
             margin-top: 20px;
             padding-top: 40px; /* Space for signature */
             border-top: 1px solid #000;
        }
         .signature-box .label { display: block; } /* Ensure labels are block */
         .signature-box.left { margin-right: 5%; }

        /* Add more specific styles to match the form layout */

    </style>
</head>
<body>
    <h2>SINGLE ENGAGEMENT COLLECTIVE BARGAINING AGREEMENT</h2>
    <h3>Associated Musicians of Greater New York - Local 802, A.F. of M.</h3>
    {# Add address/phone if needed #}

    <div class="header-info">
        <table>
            <tr>
                <td><span class="label">ENGAGEMENT DATE:</span> {{ contract.engagement_date.strftime('%Y-%m-%d') if contract.engagement_date else '' }}</td>
                <td><span class="label">LEADER/EMPLOYER NAME:</span> {{ contract.leader_name or '' }}</td>
                <td><span class="label">CARD NO:</span> {{ contract.leader_card_no or '' }}</td>
            </tr>
             <tr>
                 <td colspan="2"><span class="label">LEADER/EMPLOYER ADDRESS:</span> {{ contract.leader_address or '' }}</td>
                 <td><span class="label">LEADER SSN/EIN:</span> {{ contract.leader_ssn_ein or '' }}</td> {# PII! #}
            </tr>
            <tr>
                 <td colspan="2"><span class="label">NAME OF BAND/GROUP:</span> {{ contract.band_name or 'N/A' }}</td>
                 <td><span class="label">PHONE:</span> {{ contract.leader_phone or '' }}</td>
            </tr>
            <tr>
                 <td colspan="3"><span class="label">PLACE OF ENGAGEMENT (VENUE/ROOM):</span> {{ contract.venue_name or '' }}</td>
            </tr>
            <tr>
                 <td><span class="label">LOCATION:</span> {{ contract.location_borough or '' }}</td>
                 <td><span class="label">TYPE OF ENGAGEMENT:</span> {{ contract.engagement_type or '' }}</td>
                 <td><span class="label">NO. OF MUSICIANS:</span> {{ contract.num_musicians or '' }}</td>
            </tr>
            <tr>
                 <td>
                    <span class="label">TIME:</span>
                    From: {{ contract.start_time.strftime('%I:%M %p') if contract.start_time else '__:__'}}
                    To: {{ contract.end_time.strftime('%I:%M %p') if contract.end_time else '__:__'}}
                 </td>
                 <td>
                     <span class="label">HOURS:</span> {{ contract.actual_hours_engagement or 'N/A' }}
                     {% if contract.pre_heat_hours %} (Pre: {{ contract.pre_heat_hours }}h){% endif %}
                 </td>
                 <td>
                    <span class="label">REHEARSAL:</span> {% if contract.has_rehearsal %} Yes ({{ contract.actual_hours_rehearsal or 'N/A' }} hrs) {% else %} No {% endif %}
                 </td>
            </tr>
        </table>
    </div>

    {# --- Musician Roster --- #}
    <p style="text-align:center; font-size: 9pt; margin: 5px 0;">(Musician Details & Signatures would appear here in a full implementation - This is simplified)</p>
    <table class="musician-table">
        <thead>
            <tr>
                <th>#</th>
                <th>PRINT NAME</th>
                <th>SOC. SEC. #</th> {# PII! #}
                <th>INSTRUMENT</th>
                <th>DBL</th>
                <th>CART</th>
                <th>Gross Scale Comp.</th>
                {# Add other columns like Pension/Health/Dues per musician if needed #}
            </tr>
        </thead>
        <tbody>
            {# Leader Row (Simplified) #}
            <tr>
                <td>1 (L)</td>
                <td>{{ contract.leader_name or '' }}</td>
                <td>{{ contract.leader_ssn_ein or '' }}</td> {# PII! #}
                <td>(Leader Inst.)</td> {# TODO: Add leader instrument field #}
                <td>No</td> {# TODO: Add leader doubling flag #}
                <td>No</td> {# TODO: Add leader cartage flag #}
                <td>${{ "%.2f"|format( (contract.total_gross_comp or 0) / (contract.num_musicians or 1) ) }}</td> {# Rough estimate #}
            </tr>
            {# Side Musician Rows #}
            {% for musician in musicians %}
            <tr>
                <td>{{ loop.index + 1 }}</td>
                <td>{{ musician.name or '' }}</td>
                <td>{% if musician.ssn and musician.ssn|length >= 4 %}***-**-{{ musician.ssn[-4:] }}{% else %}N/A{% endif %}</td>
                <td>{{ musician.instrument or '' }}</td>
                <td>{{ 'Yes' if musician.is_doubling else 'No' }}</td>
                <td>{{ 'Yes' if musician.has_cartage else 'No' }}</td>
                <td>${{ "%.2f"|format( (contract.total_gross_comp or 0) / (contract.num_musicians or 1) ) }}</td> {# Rough estimate #}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {# --- Totals Summary --- #}
     <table class="totals-table">
         <tr>
             <td class="label">TOTAL GROSS SCALE COMP.</td>
             <td>${{ "%.2f"|format(contract.total_gross_comp or 0.00) }}</td>
         </tr>
          <tr>
             <td class="label">3.5% WORK DUES</td>
             <td>${{ "%.2f"|format(contract.total_work_dues or 0.00) }}</td>
         </tr>
          <tr>
             <td class="label">PENSION (AFM-EPF)</td>
             <td>${{ "%.2f"|format(contract.total_pension or 0.00) }}</td>
         </tr>
          <tr>
             <td class="label">HEALTH (HBP)</td>
             <td>${{ "%.2f"|format(contract.total_health or 0.00) }}</td>
         </tr>
     </table>


    {# --- Clauses (Add relevant clauses here as static text or conditional) --- #}
    <div class="content-block" style="font-size: 8pt; margin-top: 20px;">
        <p><strong>STANDARD CLAUSES (Abbreviated):</strong> Employer employs musicians and agrees to abide by Union bylaws regarding compensation, working conditions, pension, and health benefits. No performance shall be recorded without specific written agreement. AFM/Union rules are adhered to. Musicians may cease service due to strikes/unfair lists. Union representatives have access. Employees must be members in good standing (subject to LMRA). Disputes handled via grievance/arbitration. Pension/Health contributions payable to AFM-EPF/HBP Trusts as per Trust Agreements (incorporated by reference). Contributions due within 30 days via check/money order with remittance form. Employer provides necessary info and permits audits. Leader cannot make contributions unless incorporated. (Full text available).</p>
        {% if contract.is_recorded %}
        <p><strong>RECORDING NOTE:</strong> Performance recording was indicated. A separate written agreement with the Union/AFM is required.</p>
        {% endif %}
    </div>

    {# --- Signatures --- #}
    <div class="signature-section">
        <div class="signature-box left">
            FOR THE LOCAL 802:
            <br><br>
             <span class="label">BY:</span> _________________________
             <br>
             <span class="label">TITLE:</span> _________________________
             <br>
             <span class="label">DATE:</span> _________________________
        </div>
        <div class="signature-box right">
             FOR THE LEADER/EMPLOYER:
             <br><br>
             <span class="label">BY:</span> _________________________
              <br>
             <span class="label">TITLE:</span> _________________________
              <br>
             <span class="label">DATE:</span> _________________________
        </div>
    </div>

</body>
</html>
