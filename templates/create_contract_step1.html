{% extends "base.html" %}
{% block title %}Create Contract - Step {{ step_num }}{% endblock %}
{% block content %}
  <h2>Create Contract - Step {{ step_num }}: Basic Engagement Info</h2>
  <hr>
  <form method="POST" action="{{ url_for('create_contract_step', contract_id=contract.id, step_num=step_num) }}">

    {# Include _form_errors.html if you create it later #}
    {# {% include '_form_errors.html' %} #}

    <div class="row g-3 mb-4 form-step">
      <div class="col-md-4">
        <label for="engagement_date" class="form-label required">Engagement Date</label>
        <input type="date" class="form-control" id="engagement_date" name="engagement_date" value="{{ contract.engagement_date.strftime('%Y-%m-%d') if contract.engagement_date else '' }}" required>
      </div>
       <div class="col-md-4">
        <label for="start_time" class="form-label required">Start Time</label>
        <input type="time" class="form-control" id="start_time" name="start_time" value="{{ contract.start_time.strftime('%H:%M') if contract.start_time else '' }}" required>
      </div>
       <div class="col-md-4">
        <label for="end_time" class="form-label required">End Time</label>
        <input type="time" class="form-control" id="end_time" name="end_time" value="{{ contract.end_time.strftime('%H:%M') if contract.end_time else '' }}" required>
      </div>

      <div class="col-md-6">
        <label for="leader_name" class="form-label required">Leader/Employer Name</label>
        <input type="text" class="form-control" id="leader_name" name="leader_name" value="{{ contract.leader_name or '' }}" required>
      </div>
       <div class="col-md-6">
        <label for="leader_card_no" class="form-label">Leader's AFM Card No.</label>
        <input type="text" class="form-control" id="leader_card_no" name="leader_card_no" value="{{ contract.leader_card_no or '' }}">
      </div>

       <div class="col-12">
        <label for="leader_address" class="form-label required">Leader/Employer Address</label>
        <input type="text" class="form-control" id="leader_address" name="leader_address" placeholder="Street, City, State, Zip" value="{{ contract.leader_address or '' }}" required>
         {# Consider splitting address fields into street, city, state, zip later for better validation/use #}
      </div>

       <div class="col-md-6">
        <label for="leader_phone" class="form-label required">Leader/Employer Phone</label>
        <input type="tel" class="form-control" id="leader_phone" name="leader_phone" value="{{ contract.leader_phone or '' }}" required>
      </div>
      <div class="col-md-6">
        <label for="leader_ssn_ein" class="form-label">Leader SSN or EIN</label>
        <input type="text" class="form-control" id="leader_ssn_ein" name="leader_ssn_ein" value="{{ contract.leader_ssn_ein or '' }}">
         <div class="pii-warning">Warning: Sensitive Data. Handle with extreme care in production (encryption).</div>
      </div>

       <div class="col-md-6">
        <label for="band_name" class="form-label">Name of Band/Group</label>
        <input type="text" class="form-control" id="band_name" name="band_name" value="{{ contract.band_name or '' }}">
      </div>
       <div class="col-md-6">
        <label for="venue_name" class="form-label required">Place of Engagement (Venue/Room)</label>
        <input type="text" class="form-control" id="venue_name" name="venue_name" value="{{ contract.venue_name or '' }}" required>
      </div>

      <div class="col-md-6">
         <label for="location_borough" class="form-label required">Location (Borough/Area)</label>
         <select class="form-select" id="location_borough" name="location_borough" required>
           <option value="" {% if not contract.location_borough %}selected{% endif %} disabled>Choose...</option>
           <option value="NYC" {% if contract.location_borough == 'NYC' %}selected{% endif %}>NYC (Manhattan)</option>
           <option value="BKLYN" {% if contract.location_borough == 'BKLYN' %}selected{% endif %}>Brooklyn</option>
           <option value="QNS" {% if contract.location_borough == 'QNS' %}selected{% endif %}>Queens</option>
           <option value="BX" {% if contract.location_borough == 'BX' %}selected{% endif %}>Bronx</option>
           <option value="SI" {% if contract.location_borough == 'SI' %}selected{% endif %}>Staten Island</option>
           <option value="NAS_SUF" {% if contract.location_borough == 'NAS_SUF' %}selected{% endif %}>Nassau/Suffolk</option>
           <option value="OOT" {% if contract.location_borough == 'OOT' %}selected{% endif %}>Out of Town</option>
         </select>
      </div>
       <div class="col-md-6">
        <label for="engagement_type" class="form-label required">Type of Engagement</label>
        <input type="text" class="form-control" id="engagement_type" name="engagement_type" placeholder="e.g., Wedding, Concert" value="{{ contract.engagement_type or '' }}" required>
      </div>
       <div class="col-md-6">
        <label for="pre_heat_hours" class="form-label">Pre-Heat Hours (if applicable)</label>
        <input type="number" step="0.1" min="0" class="form-control" id="pre_heat_hours" name="pre_heat_hours" value="{{ contract.pre_heat_hours if contract.pre_heat_hours is not none else '' }}">
      </div>
    </div>

    <div class="d-flex justify-content-end">
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary me-2">Cancel & Exit</a>
        <button type="submit" class="btn btn-primary">Save and Continue to Step 2</button>
    </div>

  </form>
{% endblock %}
